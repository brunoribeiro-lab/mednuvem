function message(msg, type, title) {
    let icon = 'error';
    if (type === 'success') {
        icon = 'success';
    }
    Swal.fire({
        title: title,
        html: msg,
        icon: icon,
        timer: type === 'success' ? 4000 : 6000,
        confirmButtonText: 'Fechar',
        showCancelButton: false,
        confirmButtonColor: "#5156be",
        cancelButtonColor: "#fd625e"
    }).then((result) => {
        /* Read more about handling dismissals below */
        if (result.dismiss === Swal.DismissReason.timer) {
            console.log('I was closed by the timer')
        }
    });
}
$(document).ready(function () {
    $("#input-phone").inputmask("(99) 9 9999-9999");
    $("#input-cpf").inputmask("999.999.999-99");
    $("#recovery-type").chosen({'width': "100%", "disable_search": true});
    $('#recovery-type').change(function () {
        let $val = $(this).val();
        $(".box-option").addClass('hidden');
        switch ($val) {
            case 'phone':
                $("#box-phone").removeClass('hidden');
                break;
            case 'email':
                $("#box-email").removeClass('hidden');
                break;
            case 'cpf':
                $("#box-cpf").removeClass('hidden');
                break;
        }
    });
    $("#recovery-form").validate({
        errorElement: 'span',
        errorClass: 'error',
        focusInvalid: true,
        ignore: ":hidden",
        rules: {},
        errorPlacement: function (error, element) {
            var icon = $(element).parent('.input-with-icon').children('i');
            var parent = $(element).parent('.input-with-icon');
            icon.removeClass('fa fa-check').addClass('fa fa-exclamation');
            parent.removeClass('success-control').addClass('error-control');

        },
        highlight: function (element) {
            var parent = $(element).parent();
            parent.removeClass('success-control').addClass('error-control');
        },
        success: function (label, element) {
            var icon = $(element).parent('.input-with-icon').children('i');
            var parent = $(element).parent('.input-with-icon');
            icon.removeClass("fa fa-exclamation").addClass('fa fa-check');
            parent.removeClass('error-control').addClass('success-control');
        },
        invalidHandler: function () {
            $('#recovery-form button[type=submit], input[type=submit]').attr('disabled', false);
            // $("#loading").addClass("hidden");
            $('#recovery-form button[type=submit], input[type=submit]').html('Login');
        },
        submitHandler: function (form) {
            $("#recovery-form #result").html('');
            $('#recovery-form button[type=submit], input[type=submit]').attr('disabled', true);
            $('#recovery-form button[type=submit], input[type=submit]').html('<div class="preloader preloader-splash no-margin"><div class="preloader-spinner preloader-container"><div class="preloader-spinner preloader-fill"><div class="preloader-clipper left"><div class="preloader-circle"></div></div><div class="preloader-gap-patch"><div class="preloader-circle"></div></div><div class="preloader-clipper right"><div class="preloader-circle"></div></div></div></div></div>')
            //$("#recovery-form #loading").removeClass("hidden");
            console.log("Submit");
            data = new FormData($(form)[0]);
            $.ajax({
                url: "login/recovery",
                type: "POST",
                data: data,
                processData: false,
                contentType: false,
                success: function (data) {
                    //  $("#recovery-form #loading").addClass("hidden");
                    if (data.error) {
                        message(data.msg, 'danger', "Erro ao recuperar");
                    } else {
                        $("#recovery-form").trigger('reset');
                        message(data.msg, 'success', "Email Enviado");
                        // window.location.href = data.redirect;
                        //   $('#recovery-form button[type=submit], input[type=submit]').addClass('hidden');

                    }
                },
                complete: function () {
                    $('#recovery-form button[type=submit], input[type=submit]').attr('disabled', false);
                    $("#recovery-form #loading").addClass("hidden");
                    $('#recovery-form button[type=submit], input[type=submit]').html('Login');
                }
            });
            return false;
        }
    })
});